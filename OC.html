<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1.0" name="viewport" />
  <title>Cercle de Lecture</title>
  <style>
    body {
      background: linear-gradient(to right, #e0f7fa, #e1f5fe);
      color: #003344;
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
    }

    .container {
      max-width: 800px;
      margin: 30px auto;
      background: linear-gradient(135deg, #ffffff, #f9fbe7);
      padding: 30px;
      border-radius: 10px;
      border: 2px solid #c5e1a5;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
      animation: fadeIn 0.8s ease-in-out;
    }

    .hidden {
      display: none;
    }

    .notif-area {
      text-align: right;
      margin-bottom: 10px;
      font-size: 18px;
    }

    button {
      margin-top: 10px;
      padding: 10px 20px;
      border: none;
      border-radius: 6px;
      background-color: #007acc;
      color: white;
      cursor: pointer;
      font-size: 16px;
      transition: all 0.2s ease-in-out;
    }

    button:hover {
      background-color: #388e3c !important;
      transform: scale(1.05);
    }

    table {
      width: 100%;
      margin-top: 20px;
      border-collapse: collapse;
    }

    table, th, td {
      border: 1px solid #ccc;
    }

    th, td {
      padding: 10px;
      text-align: left;
    }

    .completed {
      background-color: #d4ffd4;
    }

    h2, h3, h4, label {
      color: #004d66;
      font-family: 'Comic Sans MS', cursive;
    }

    input, select {
      width: 100%;
      padding: 12px;
      margin-top: 5px;
      margin-bottom: 15px;
      border-radius: 8px;
      border: 1px solid #ccc;
      box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
      font-size: 16px;
    }

    select {
      background-color: #f0f9ff;
    }

    #book-table h4 {
      background-color: #aed581;
      padding: 10px;
      border-radius: 8px;
      color: #1b5e20;
    }

    ul {
      padding-left: 20px;
    }

    ul li {
      margin-bottom: 5px;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
  </style>
  <script>
    const BIN_ID = "681cc2988960c979a59593c4";
    const API_KEY = "$2a$10$e8COjJNqV/ReJs5XiIW7aOntP2QEh3F8EDXCeUmx4oMyRzg2NHobm";

    function loadOnlineData(callback) {
      fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}/latest`, {
        headers: { "X-Master-Key": API_KEY }
      })
        .then(res => res.json())
        .then(json => callback(json.record.data))
        .catch(() => callback([]));
    }

    function saveOnlineData(data) {
      fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}`, {
        method: "PUT",
        headers: {
          "Content-Type": "application/json",
          "X-Master-Key": API_KEY
        },
        body: JSON.stringify({ data })
      });
    }
  </script>
</head>

<head>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1.0" name="viewport" />
  <title>Cercle de Lecture</title>
  <style>
    body {
      background: linear-gradient(to right, #e0f7fa, #e1f5fe);
      color: #003344;
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
    }

    .container {
      max-width: 800px;
      margin: 30px auto;
      background: linear-gradient(135deg, #ffffff, #f9fbe7);
      padding: 30px;
      border-radius: 10px;
      border: 2px solid #c5e1a5;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
      animation: fadeIn 0.8s ease-in-out;
    }

    .hidden {
      display: none;
    }

    .notif-area {
      text-align: right;
      margin-bottom: 10px;
      font-size: 18px;
    }

    button {
      margin-top: 10px;
      padding: 10px 20px;
      border: none;
      border-radius: 6px;
      background-color: #007acc;
      color: white;
      cursor: pointer;
      font-size: 16px;
      transition: all 0.2s ease-in-out;
    }

    button:hover {
      background-color: #388e3c !important;
      transform: scale(1.05);
    }

    table {
      width: 100%;
      margin-top: 20px;
      border-collapse: collapse;
    }

    table, th, td {
      border: 1px solid #ccc;
    }

    th, td {
      padding: 10px;
      text-align: left;
    }

    .completed {
      background-color: #d4ffd4;
    }

    h2, h3, h4, label {
      color: #004d66;
      font-family: 'Comic Sans MS', cursive;
    }

    input, select {
      width: 100%;
      padding: 12px;
      margin-top: 5px;
      margin-bottom: 15px;
      border-radius: 8px;
      border: 1px solid #ccc;
      box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
      font-size: 16px;
    }

    select {
      background-color: #f0f9ff;
    }

    #book-table h4 {
      background-color: #aed581;
      padding: 10px;
      border-radius: 8px;
      color: #1b5e20;
    }

    ul {
      padding-left: 20px;
    }

    ul li {
      margin-bottom: 5px;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
  </style>
  <script>
    const BIN_ID = "681cc2988960c979a59593c4";
    const API_KEY = "$2a$10$e8COjJNqV/ReJs5XiIW7aOntP2QEh3F8EDXCeUmx4oMyRzg2NHobm";

    function loadOnlineData(callback) {
      fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}/latest`, {
        headers: { "X-Master-Key": API_KEY }
      })
        .then(res => res.json())
        .then(json => callback(json.record.data))
        .catch(() => callback([]));
    }

    function saveOnlineData(data) {
      fetch(`https://api.jsonbin.io/v3/b/${BIN_ID}`, {
        method: "PUT",
        headers: {
          "Content-Type": "application/json",
          "X-Master-Key": API_KEY
        },
        body: JSON.stringify({ data })
      });
    }
  </script>
</head>
<body>
  <div class="container" id="login-section">
    <h2>Connexion</h2>
    <label>Es-tu un √©l√®ve ou un professeur ?</label>
    <select id="role" onchange="showLoginForm()">
      <option value="">-- Choisir --</option>
      <option value="eleve">√âl√®ve</option>
      <option value="prof">Professeur</option>
    </select>
    <div class="hidden" id="login-form">
      <label>Identifiant</label>
      <input id="username" type="text" />
      <label>Mot de passe</label>
      <input id="password" type="password" />
      <button onclick="login()">Se connecter</button>
    </div>
  </div>

  <div class="container hidden" id="student-section">
    <h3 id="student-welcome"></h3>
    <label for="book">Choisir un livre</label>
    <select id="book" onchange="updateRoles()"></select>
    <label for="roleChoice">Choisir un r√¥le</label>
    <select id="roleChoice"></select>
    <button onclick="enregistrerRole()">Valider</button>
    <button onclick="voirHistorique()">Voir mon historique</button>
    <div class="hidden" id="historique-eleve"></div>
  </div>

  <div class="container hidden" id="professor-section">
    <div class="notif-area">
      <span>üîî Notifications : </span><span id="notif-count">0</span>
    </div>
    <button id="clear-history-button" onclick="clearStudentHistoryPrompt()">üßπ Effacer l'historique d'un √©l√®ve</button>
    <button onclick="voirHistoriqueTous()">Voir tout l'historique</button>
    <button onclick="exportHistorique('pdf')">üìÑ Exporter en PDF</button>
    <button onclick="exportHistorique('excel')">üìä Exporter en Excel</button>
    <button id="clear-book-entry-button" onclick="clearStudentBookEntry()">üóëÔ∏è Supprimer un livre pour un √©l√®ve</button>
    <div id="book-table"></div>
  </div>
</body>

</html>
